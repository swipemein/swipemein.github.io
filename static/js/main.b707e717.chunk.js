(this.webpackJsonpswipemein=this.webpackJsonpswipemein||[]).push([[0],{56:function(e,t,a){e.exports=a(76)},61:function(e,t,a){},74:function(e,t,a){},76:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),i=a(28),r=a.n(i),c=(a(61),a(37)),o=a(20),s=a(8),u=(a(24),a(23),a(6)),m=a(7),d=a(10),p=a(9),h=a(11),f=function(){function e(){Object(u.a)(this,e)}return Object(m.a)(e,null,[{key:"getRedirectUrl",value:function(){var e="https://oidc.mit.edu/authorize?response_type=code";return[["client_id",this.clientID],["redirect_uri",this.redirectURI],["scope",this.scope]].forEach((function(t){var a=t[0],n=t[1];e+="&"+a+"="+n})),e}},{key:"login",value:function(e){this.requestToken(e)}},{key:"requestToken",value:function(e){var t=this,a=new XMLHttpRequest;a.onreadystatechange=function(){return t.receiveToken(a)},a.open("POST","https://oidc.mit.edu/token"),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.responseType="json";var n="grant_type=authorization_code";n+="&code="+e,n+="&redirect_uri=https://swipemein.github.io/",n+="&client_id=8fbfe55e-51b6-40df-a8e2-0a38690e2a9f",n+="&client_secret=D1vTFSOtY8zdbsiliGbDWf8tJCMtJ7IWPkLyROnp4yxhgpQWqeBRQWGRjj6NEFl_M4dt5k9dvgAA8k4v2poWxQ",a.send(n)}},{key:"receiveToken",value:function(e){var t=this;if(e.readyState===XMLHttpRequest.DONE){var a=new XMLHttpRequest;a.onreadystatechange=function(){return t.getUserInfo(a)},a.open("GET","https://oidc.mit.edu/userinfo"),a.setRequestHeader("Authorization","Bearer "+e.response.access_token),a.responseType="json",a.send()}}},{key:"getUserInfo",value:function(e){if(e.readyState===XMLHttpRequest.DONE){var t=e.response,a=s.firestore().collection("users").doc(t.sub);localStorage.setItem("subID",t.sub),console.log(localStorage.getItem("subID")),a.get().then((function(e){e.exists||(console.log(t),console.log("does not exist"),e.set({email:t.email,name:t.name,anon:!1,reputation:1}))})),window.location.reload()}}},{key:"logOut",value:function(){localStorage.removeItem("subID")}},{key:"isLoggedIn",value:function(){return null!==localStorage.getItem("subID")}},{key:"redirectLogin",value:function(){return l.a.createElement(o.a,{to:"/login",exact:!0})}}]),e}();f.clientID="8fbfe55e-51b6-40df-a8e2-0a38690e2a9f",f.responseType="code",f.scope="openid profile email",f.redirectURI="https://swipemein.github.io/";var E=f,v=a(80),w=a(81),b=(a(17),a(74),function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={loggedIn:!(null===localStorage.getItem("subID"))},a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e;return e=this.state.loggedIn?l.a.createElement(l.a.Fragment,null,l.a.createElement(v.a.Link,{href:"/#/dashboard"},"Dashboard"),l.a.createElement(v.a.Link,{href:"/#/profile"},"Profile"),l.a.createElement(v.a.Link,{href:"/",onClick:function(){return E.logOut()}},"Logout")):l.a.createElement(l.a.Fragment,null,l.a.createElement(v.a.Link,{href:"/#/login"},"Login")),l.a.createElement(w.a,null,l.a.createElement(w.a.Brand,{href:"/"},"SwipeMeIn"),l.a.createElement(w.a.Collapse,null,l.a.createElement(v.a,{className:"ml-auto"},e)))}}]),t}(n.Component)),g=a(83),y=function(e){function t(e){var a;Object(u.a)(this,t),a=Object(d.a)(this,Object(p.a)(t).call(this,e));var n=window.location.href;if(n.includes("code")&&null===localStorage.getItem("subID")){var l=n.split("?")[1].split("#")[0].split("=")[1];E.login(l)}return a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement(b,null),l.a.createElement("div",{class:"container-fluid homephotos"},l.a.createElement("div",{class:"hometitle container"},l.a.createElement("h2",null,"SwipeMeIn")),l.a.createElement("div",{class:"homeinfo container-fluid"},l.a.createElement("div",{class:"col-xs-4 homedescription"},l.a.createElement("div",{class:"container"},l.a.createElement("h3",null,"What is SwipeMeIn?")),l.a.createElement("div",{class:"container"},l.a.createElement("p",null,"We\u2019ve all been there: it\u2019s 7 PM, you\u2019re on campus, and you\u2019re hungry. You have two options: spend an absurd amount of money for on-campus dining or ask a friend to lend you a swipe."),l.a.createElement("p",null,"With meal plan minimums increasing and limited swipe donation programs to take advantage of, countless students end each year with extra swipes that are wasted. SwipeMeIn is a platform for those with extra swipes to make the most of their surplus and the hungry to score a free meal.")),l.a.createElement("div",{class:"homedirections row container"},l.a.createElement("div",{class:"col"},l.a.createElement(k,{title:"Log in",text:"Log in using your kerberos in OIDC."})),l.a.createElement("div",{class:"col"},l.a.createElement(k,{title:"Add/Claim a Swipe",text:"Say where and when you'll eat, or find a place and time that works for your stomach."})),l.a.createElement("div",{class:"col"},l.a.createElement(k,{title:"Get Swiped!",text:"Eat!"})))))))}}]),t}(n.Component),k=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return l.a.createElement(g.a,null,l.a.createElement(g.a.Body,null,l.a.createElement(g.a.Title,null,this.props.title),l.a.createElement(g.a.Text,null,this.props.text)))}}]),t}(n.Component),O=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t.name,n=void 0===a?"Student Name":a,l=t.email,i=void 0===l?"studentemail@mit.edu":l,r=t.anon,c=void 0!==r&&r,o=t.rep,s=void 0===o?0:o;Object(u.a)(this,e),this.name=n,this.email=i,this.anon=c,this.rep=s}return Object(m.a)(e,[{key:"getRepString",value:function(){return this.rep>.5?"Good":"Bad"}}]),e}();function j(e){var t=e.data();return new O({name:t.name,email:t.email,anon:t.anon,rep:t.rep})}function I(e){var t=e.data();return new D({location:t.location,swipeTime:new Date(1e3*t.swipeTime.seconds),available:t.available,claimed:t.claimed,owner:new O,active:t.active,cancelled:t.cancelled,timeCreated:new Date(1e3*t.timeCreated.seconds),firebaseID:e.id})}var D=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t.location,n=void 0===a?"Location":a,l=t.swipeTime,i=void 0===l?new Date(2e3,1,1,1,1,0,0):l,r=t.available,c=void 0===r?0:r,o=t.claimed,s=void 0===o?0:o,m=t.owner,d=void 0===m?new O:m,p=t.active,h=void 0===p?null:p,f=t.cancelled,E=void 0===f?null:f,v=t.timeCreated,w=(void 0===v&&new Date,t.firebaseID),b=void 0===w?null:w;Object(u.a)(this,e),this.location=n,this.time=i,this.amount=c,this.claimed=s,this.owner=d,this.active=h,this.cancelled=E,this.firebaseID=b}return Object(m.a)(e,[{key:"getTimeString",value:function(){return this.time.toLocaleDateString()+", "+this.time.toLocaleTimeString()}}]),e}(),S=a(78),T=function(e){function t(e){var a;Object(u.a)(this,t);var n=(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).props.path.split("/");return a.state={swipe:new D,swipeID:n[n.length-1]},a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this;s.firestore().collection("swipes").doc(this.state.swipeID).get().then((function(t){e.setState({swipe:I(t)})}))}},{key:"render",value:function(){return l.a.createElement("div",{class:"swipecard container"},l.a.createElement("div",{class:"col-xs-4"},l.a.createElement(g.a,null,l.a.createElement(g.a.Body,null,l.a.createElement(g.a.Title,null,this.state.swipe.location),l.a.createElement(g.a.Subtitle,null,this.state.swipe.getTimeString()),l.a.createElement(g.a.Text,null),l.a.createElement(S.a,null,"Claim Swipe"),l.a.createElement(g.a.Link,{href:"/#/swipeinfo/"+this.state.swipeID},"Info")))))}}]),t}(n.Component),C=a(79),L=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={student:new O,swipePaths:[]},a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=localStorage.getItem("subID"),a=s.firestore().collection("users").doc(t);a.get().then((function(t){e.setState({student:j(t)})})),a.collection("swipes").get().then((function(t){var a=[];t.docs.forEach((function(e){a.push(e.data().swipe.path)})),e.setState({swipePaths:a})}))}},{key:"render",value:function(){if(!E.isLoggedIn())return E.redirectLogin();var e=this.state.student,t=[];return this.state.swipePaths.forEach((function(e){t.push(l.a.createElement(T,{path:e,key:e}))})),l.a.createElement("div",null,l.a.createElement(b,null),l.a.createElement("div",{class:"container"},l.a.createElement("h1",{class:"pagetitle"},"Profile")),l.a.createElement("div",{class:"container"},l.a.createElement("div",{class:"container"},l.a.createElement("h5",null,"Info"),l.a.createElement("div",{class:"container"},l.a.createElement(C.a,null,l.a.createElement(C.a.Group,null,l.a.createElement(C.a.Label,null,"Name:"),l.a.createElement(C.a.Control,{placeholder:e.name})),l.a.createElement(C.a.Group,null,l.a.createElement(C.a.Label,null,"Email:"),l.a.createElement(C.a.Control,{type:"email",placeholder:e.email})),l.a.createElement(C.a.Group,null,l.a.createElement(C.a.Label,null,"Anonymity:"),l.a.createElement(C.a.Check,{type:"switch",label:"Anonymous - swipers will not see your name when you claim or advertise a swipe.",defaultValue:e.anon})),l.a.createElement(C.a.Group,null,l.a.createElement(C.a.Label,null,"Reputation:"),l.a.createElement(C.a.Control,{plaintext:!0,readOnly:!0,placeholder:e.getRepString()})))),l.a.createElement("div",{class:"container row"},l.a.createElement("div",{class:"col-xs-4"},l.a.createElement("h5",null,"Your swipes"),l.a.createElement("div",{class:"container"},t)),l.a.createElement("div",{class:"col-xs-4"},l.a.createElement("h5",null,"Swipes you've claimed"),l.a.createElement("div",{class:"container"}))))))}}]),t}(n.Component),x={apiKey:"AIzaSyDdmc4unsGL4p64Lrl7GH5uQ7iJZ3gEnqo",authDomain:"swipemein-20d09.firebaseapp.com",databaseURL:"https://swipemein-20d09.firebaseio.com",projectId:"swipemein-20d09",storageBucket:"swipemein-20d09.appspot.com",messagingSenderId:"106834805176",appId:"1:106834805176:web:7431e8cf5325603a99cf4d",measurementId:"G-248JREEMRL"},R=["Maseeh","McCormick","Baker","Next","Simmons"],M=["Reliable","Somewhat Reliable","Flaky"],F=a(82),G=a(55),B=a.n(G),A=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).updated=!1,a.state={swipesData:[],filter:{}},a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"getTimestamp",value:function(e,t){var a,n=this.state.filter;return"Today"===n[t]?a=new Date(Date.now()):"Tomorrow"===n[t]&&(a=new Date(Date.now()+864e5)),a.setHours(parseInt(n[e].split(":")[0])),a.setMinutes(parseInt(n[e].split(":")[1])),a.getTime()}},{key:"makeCheckboxes",value:function(e){var t=[];return e.forEach((function(e){t.push(l.a.createElement(C.a.Check,{type:"checkbox",label:e,key:e,id:e,name:e,defaultChecked:!0}))})),t}},{key:"checkFilterComplete",value:function(){var e=this.state.filter;return""===e.starttime?(alert("Please enter a start time."),!1):""===e.endtime?(alert("Please enter an end time."),!1):!(this.getTimestamp("endtime","endtimeday")<this.getTimestamp("starttime","starttimeday"))||(alert("End time must be after start time."),!1)}},{key:"componentDidUpdate",value:function(){var e=this;if(0!==Object.keys(this.state.filter).length)if(this.updated)this.updated=!1;else if(this.checkFilterComplete()){this.updated=!0;var t=s.firestore().collection("swipes"),a=R.filter((function(t){return e.state.filter[t]}));t.where("swipeTime",">=",s.firestore.Timestamp.fromMillis(this.getTimestamp("starttime","starttimeday"))).where("swipeTime","<=",s.firestore.Timestamp.fromMillis(this.getTimestamp("endtime","endtimeday"))).where("location","in",a).get().then((function(t){var a=[];t.docs.forEach((function(e){a.push(e.id)})),e.setState({swipesData:a})}))}}},{key:"componentDidMount",value:function(){var e=this;s.firestore().collection("swipes").where("swipeTime",">=",new Date(Date.now())).where("swipeTime","<=",new Date(Date.now()+864e5)).get().then((function(t){var a=[];t.docs.forEach((function(e){a.push(e.id)})),e.setState({swipesData:a})}))}},{key:"getFilteredResults",value:function(e){e.preventDefault();var t={};["starttime","endtime"].forEach((function(e){t[e]=document.getElementById(e).value})),R.concat(M).forEach((function(e){t[e]=document.getElementById(e).checked})),["starttimeday","endtimeday"].forEach((function(e){t[e]=B()("input:radio[name="+e+"]:checked").val()})),this.setState({filter:t})}},{key:"getFormFormattedTime",value:function(e){return(e.getHours()>=10?e.getHours():"0"+e.getHours())+":"+(e.getMinutes()>=10?e.getMinutes():"0"+e.getMinutes())}},{key:"render",value:function(){var e=this;if(!E.isLoggedIn())return E.redirectLogin();var t=[];this.state.swipesData.forEach((function(e){t.push(l.a.createElement(T,{path:e,key:e}))}));var a=this.makeCheckboxes(R),n=this.makeCheckboxes(M);return l.a.createElement(l.a.Fragment,null,l.a.createElement(b,null),l.a.createElement("div",{class:"container"},l.a.createElement("h1",{class:"pagetitle"},"Swipe Dashboard")),l.a.createElement("div",{class:"container"},l.a.createElement("div",{class:"row container",id:"middashboard"},l.a.createElement("div",{class:"col"},l.a.createElement(F.a,null,l.a.createElement(g.a,null,l.a.createElement(g.a.Header,null,l.a.createElement(F.a.Toggle,{as:S.a,eventKey:"0"},"Filter")),l.a.createElement(F.a.Collapse,{eventKey:"0"},l.a.createElement(g.a.Body,null,l.a.createElement(C.a,{onSubmit:function(t){return e.getFilteredResults(t)},id:"filterform",name:"filterform"},l.a.createElement("h2",null,"Dining Halls:"),l.a.createElement(C.a.Group,null,a),l.a.createElement("h2",null,"Swipe Me In Between:"),l.a.createElement(C.a.Group,null,l.a.createElement(C.a.Label,null,"Start"),l.a.createElement(C.a.Control,{type:"time",id:"starttime",defaultValue:this.getFormFormattedTime(new Date(Date.now()))}),l.a.createElement(C.a.Row,null,l.a.createElement(C.a.Check,{type:"radio",name:"starttimeday",label:"Today",value:"Today",defaultChecked:!0}),l.a.createElement(C.a.Check,{type:"radio",name:"starttimeday",label:"Tomorrow",value:"Tomorrow"})),l.a.createElement(C.a.Label,null,"End"),l.a.createElement(C.a.Control,{type:"time",id:"endtime",defaultValue:this.getFormFormattedTime(new Date(Date.now()+864e5))}),l.a.createElement(C.a.Row,null,l.a.createElement(C.a.Check,{type:"radio",name:"endtimeday",label:"Today",value:"Today"}),l.a.createElement(C.a.Check,{type:"radio",name:"endtimeday",label:"Tomorrow",value:"Tomorrow",defaultChecked:!0}))),l.a.createElement("h2",null,"Swiper Reputation:"),l.a.createElement(C.a.Group,null,n),l.a.createElement(F.a.Toggle,{type:"submit",as:S.a,eventKey:"0"},"Filter Results"))))))),l.a.createElement("div",{class:"col"},l.a.createElement(S.a,{class:"btn-block",href:"/#/addswipe",id:"addswipebutton"},"Add Swipe")))),l.a.createElement("div",{class:"container"},t))}}]),t}(n.Component),P=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={swipe:new D},a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=window.location.hash.split("/"),a=t[t.length-1];s.firestore().collection("swipes").doc(a).get().then((function(t){e.setState({swipe:I(t)})}))}},{key:"render",value:function(){if(!E.isLoggedIn())return E.redirectLogin();var e=this.state.swipe;return l.a.createElement(l.a.Fragment,null,l.a.createElement(b,null),l.a.createElement("div",{class:"container"},l.a.createElement("div",{class:"col-xs-4"},l.a.createElement(g.a,null,l.a.createElement(g.a.Body,null,l.a.createElement(g.a.Title,null,e.location),l.a.createElement(g.a.Subtitle,null,e.getTimeString()),l.a.createElement("ul",null,l.a.createElement("li",null,"Swipes Remaining: ",e.amount-e.claimed," / ",e.amount),l.a.createElement("li",null,"Owner: ",e.owner.name),l.a.createElement("li",null,"Owner reputation: ",e.owner.rep),l.a.createElement("li",null,"Status: ",e.cancelled?"Cancelled":"Open"),l.a.createElement("li",null,"Active: ",e.active?"Active":"Retired")),l.a.createElement(S.a,null,"Claim Swipe"))))))}}]),t}(n.Component),H=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).url=E.getRedirectUrl(),a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement(b,null),l.a.createElement("div",{class:"container"},l.a.createElement("a",{href:this.url},l.a.createElement(S.a,null,"Login"))))}}]),t}(n.Component),q=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(m.a)(t,[{key:"submitForm",value:function(e){e.preventDefault();var t={};if(["swipedininghall","swipedate","swipetime","swipecount"].forEach((function(e){t[e]=document.getElementById(e).value})),""!==t.swipedate)if(""!==t.swipetime)if(""!==t.swipecount){var a=Date.parse(t.swipedate+"T"+t.swipetime),n=s.firestore();n.collection("swipes").add({active:!0,available:parseInt(t.swipecount),cancelled:!1,claimed:0,location:t.swipedininghall,owner:n.collection("users").doc(localStorage.getItem("subID")),swipeTime:s.firestore.Timestamp.fromMillis(a),timeCreated:s.firestore.Timestamp.now()}),document.getElementById("submitbutton").disabled=!0,document.getElementById("addbutton").disabled=!1}else alert("Please enter the number of swipes.");else alert("Please enter the time of your swipe.");else alert("Please enter the date of your swipe.")}},{key:"render",value:function(){if(!E.isLoggedIn())return E.redirectLogin();var e=R.map((function(e){return l.a.createElement("option",{key:e},e)}));return l.a.createElement(l.a.Fragment,null,l.a.createElement(b,null),l.a.createElement("div",{class:"container"},l.a.createElement("h1",{class:"pagetitle"},"Add Swipe")),l.a.createElement("div",{class:"container"},l.a.createElement(g.a,null,l.a.createElement(g.a.Body,null,l.a.createElement(C.a,{onSubmit:this.submitForm,id:"swipeform"},l.a.createElement(C.a.Group,null,l.a.createElement(C.a.Label,null,"Location"),l.a.createElement(C.a.Control,{as:"select",id:"swipedininghall"},e)),l.a.createElement(C.a.Row,null,l.a.createElement("div",{class:"col-xs-4"},l.a.createElement(C.a.Group,null,l.a.createElement(C.a.Label,null,"Day"),l.a.createElement(C.a.Control,{type:"date",id:"swipedate"}))),l.a.createElement("div",{class:"col-xs-4"},l.a.createElement(C.a.Group,null,l.a.createElement(C.a.Label,null,"Time"),l.a.createElement(C.a.Control,{type:"time",id:"swipetime"})))),l.a.createElement(C.a.Group,null,l.a.createElement(C.a.Label,null,"Swipes to Give"),l.a.createElement(C.a.Control,{type:"number",min:"1",step:"1",id:"swipecount"})),l.a.createElement(S.a,{type:"submit",id:"submitbutton"},"Submit")))),l.a.createElement("div",{class:"container"},l.a.createElement("br",null),l.a.createElement("a",{href:"/#/addswipe"},l.a.createElement(S.a,{id:"addbutton",disabled:!0},"Add Another Swipe")))))}}]),t}(n.Component),W=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement(b,null),l.a.createElement("div",{class:"container"},l.a.createElement("h1",{class:"pagetitle"},"Error 404: Page not found")))}}]),t}(n.Component);var _=function(){return 0===s.apps.length&&s.initializeApp(x),l.a.createElement(l.a.Fragment,null,l.a.createElement(c.a,{basename:""},l.a.createElement(o.d,null,l.a.createElement(o.b,{exact:!0,path:"/",render:function(){return l.a.createElement(y,null)}}),l.a.createElement(o.b,{exact:!0,path:"/profile",render:function(){return l.a.createElement(L,null)}}),l.a.createElement(o.b,{exact:!0,path:"/dashboard",render:function(){return l.a.createElement(A,null)}}),l.a.createElement(o.b,{exact:!0,path:"/swipeinfo/:id",render:function(){return l.a.createElement(P,null)}}),l.a.createElement(o.b,{exact:!0,path:"/login",render:function(){return l.a.createElement(H,null)}}),l.a.createElement(o.b,{exact:!0,path:"/addswipe",render:function(){return l.a.createElement(q,null)}}),l.a.createElement(o.b,{path:"*",exact:!0,render:function(){return l.a.createElement(W,null)}}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(l.a.createElement(_,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[56,1,2]]]);
//# sourceMappingURL=main.b707e717.chunk.js.map